# Курсовой проект. Машинное обучение. Линейная регрессия



### Описание задания

Загрузите данные и посчитайте модели линейной регрессии для 50 зданий по
ансамблю регрессионных моделей: в первой модели весь оптимальный набор
метеорологических данных, во второй - дни недели и праздники,
в третьей - недели года, в четвертой - месяцы. Финальное значение показателя
рассчитайте как взвешенное арифметическое показателей всех моделей, взяв 
веса для первой и второй модели как 3/8, а для третьей и четвертой - как 1/8.

Загрузите данные решения, посчитайте значение энергопотребления для
требуемых дат для тех зданий, которые посчитаны в модели, и выгрузите
результат в виде CSV-файла (submission.csv).

Данные:
* http://video.ittensive.com/machine-learning/ashrae/building_metadata.csv.gz
* http://video.ittensive.com/machine-learning/ashrae/weather_train.csv.gz
* http://video.ittensive.com/machine-learning/ashrae/train.0.csv.gz
* http://video.ittensive.com/machine-learning/ashrae/test.csv.gz
* http://video.ittensive.com/machine-learning/ashrae/weather_test.csv.gz

Итоговый файл с кодом (.py или .ipynb) выложите в github с портфолио.


### Решение:

Импортируем необходимые модули для обработки данных Numpy, Pandas, sklearn.

При обработке больших объемов данных, одной из задач является оптимизация
памяти, т.к. объем загружаемых данных может быть больше чем объем оперативной
памяти. Для оптимизации памяти необходимо переопределить тип данных для
отдельных серий. Привести некоторые данные к целым значениям, удалить
неиспользуемые серии, а так же удалить промежуточные наборы данных. Создадим
функцию оптимизации памяти reduce_mem_usage.

Далее загрузим данные по 50-ти зданиям, погоде и энергопотреблению.
Проведем интерполяцию метеорологических данных и обогащение, добавив серию
данных с производными по температуре воздуха. Для этого создадим функцию
weather_interpolate_diff. После преобразования всех погодных данных, их можно
объединить с основным набором данных. После этого данные по погоде удаляем,
а данные по энергопотреблению оптимизируем с помощью функции reduce_mem_usage.

Теперь проведем расчеты по датам. Для обогащения данных по датам и 
логарифмированию создаем функцию add_dates_log., где добавим часы, дни 
недели, недели, месяцы и праздничные дни. Для каждой строки данных введем
параметры по принадлежности данных к определенному дню недели и определенной
недели в году. Это поможет скорректировать предсказание электропотребления
по сезонам, будням и выходным. Так же проведем логарифмирование показателя
энергопотребления, для проверки, можно ли перейти от линейной модели суммы
показателей к модели произведения.

Произведем расчет моделей линейной регрессии по часам. Создадим функцию 
calculate_model_coeffs. Введем список серии данных, по которым будем 
предсказывать и последовательно добавлять значения температуры, влажности,
давления, облачности, осадков, скорости ветра, направления ветра, производных
температуры, а так же дней недели, месяцев, праздников.

Произведем объединение данных по погоде. Далее используя функцию 
add_dates_log, произведем обогащение данных по дате. Произведем расчет
финальных показателей, только энергопотребление, только 50 первых зданий.

Выгружаем результаты в CSV-файл "submission.csv".
Освобождаем память.


## Технологии в решениях
Python 3.9,
Numpy,
Pandas,
sklearn.


### Студент
Валерий Калинин