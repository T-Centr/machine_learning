"""
ÐŸÐ¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð´Ð°Ñ‡Ð¸
Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ð¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸ Ñ€Ð°Ð·Ð´ÐµÐ»Ð¸Ð¼ Ð²Ñ‹Ð±Ð¾Ñ€ÐºÑƒ Ð½Ð° Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‰ÑƒÑŽ/Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ñ‡Ð½ÑƒÑŽ Ð² ÑÐ¾Ð¾Ñ‚Ð½Ð¾ÑˆÐµÐ½Ð¸Ð¸ 80/20.

Ð”Ð»Ñ Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‰ÐµÐ¹ Ð²Ñ‹Ð±Ð¾Ñ€ÐºÐ¸ Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ð¼ ÑÑ€ÐµÐ´Ð½Ð¸Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð²ÐµÑÐ°, Ñ€Ð¾ÑÑ‚Ð°, Ð¸Ð½Ð´ÐµÐºÑÐ° Ð¼Ð°ÑÑÑ‹
Ñ‚ÐµÐ»Ð° Ð¸ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð° - Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð¸Ð· Ð¿Ñ€Ð¸Ð½ÑÑ‚Ñ‹Ñ… Ñ€ÐµÑˆÐµÐ½Ð¸Ð¹. ÐŸÑ€ÐµÐ´ÑÐºÐ°Ð¶ÐµÐ¼ Ð¾Ñ†ÐµÐ½ÐºÑƒ ÑÐºÐ¾Ñ€Ð¸Ð½Ð³Ð° Ð¿Ð¾
Ð±Ð»Ð¸Ð·Ð¾ÑÑ‚Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… ÑÑ€ÐµÐ´Ð½Ð¸Ð¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÑÐ¼.

ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ð¼ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ñ‡ÐµÑ€ÐµÐ· F1-Ð¼ÐµÑ‚Ñ€Ð¸ÐºÑƒ Ð¸ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ Ð½ÐµÑ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÐµÐ¹.

Ð”Ð°Ð½Ð½Ñ‹Ðµ:

https://video.ittensive.com/machine-learning/prudential/train.csv.gz

Ð¡Ð¾Ñ€ÐµÐ²Ð½Ð¾Ð²Ð°Ð½Ð¸Ðµ: https://www.kaggle.com/c/prudential-life-insurance-assessment/

Â© ITtensive, 2020
"""


import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.metrics import f1_score, confusion_matrix
from sklearn.metrics import cohen_kappa_score


pd.set_option('display.max_rows', None)  # Ð¡Ð±Ñ€Ð¾Ñ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ð¹ Ð½Ð° ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾
# Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð¼Ñ‹Ñ… Ñ€ÑÐ´Ð¾Ð²

pd.set_option('display.max_columns', None)  # Ð¡Ð±Ñ€Ð¾Ñ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ð¹ Ð½Ð° Ñ‡Ð¸ÑÐ»Ð¾
# Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð¼Ñ‹Ñ… ÑÑ‚Ð¾Ð»Ð±Ñ†Ð¾Ð²

pd.set_option('display.max_colwidth', None)  # Ð¡Ð±Ñ€Ð¾Ñ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ð¹ Ð½Ð° ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾
# ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð² Ð² Ð·Ð°Ð¿Ð¸ÑÐ¸


"""Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…"""

data = pd.read_csv(
    "https://video.ittensive.com/machine-learning/prudential/train.csv.gz"
)
print(data.info())


"""Ð Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð½Ð° Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‰Ð¸Ðµ Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ñ‡Ð½Ñ‹Ðµ, 80/20"""

data_train, data_test = train_test_split(data, test_size=0.2)
print(data_train.head())


"""Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ ÑÑ€ÐµÐ´Ð½Ð¸Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¾Ñ†ÐµÐ½ÐºÐ¸"""

# ÐŸÑ€Ð¾Ð²ÐµÐ´ÐµÐ¼ ÐºÐ»Ð°ÑÑ‚ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸ÑŽ Ð´Ð°Ð½Ð½Ñ‹Ñ…: Ñ€Ð°Ð·Ð¾Ð±ÑŒÐµÐ¼ Ð¸Ñ… Ð½Ð° Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹ Ð¿Ð¾ Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾Ð¹ Ð¾Ñ†ÐµÐ½ÐºÑƒ
# ÑÐºÐ¾Ñ€Ð¸Ð½Ð³Ð° (Response), Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ð¼ Ñ†ÐµÐ½Ñ‚Ñ€Ñ‹ ÑÑ‚Ð¸Ñ… Ð³Ñ€ÑƒÐ¿Ð¿ ÐºÐ°Ðº ÑÑ€ÐµÐ´Ð½Ð¸Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ
# Ð±Ð¸Ð¾Ð¼ÐµÑ‚Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð².
columns = ["Wt", "Ht", "Ins_Age", "BMI"]
responses = np.arange(1, data["Response"].max() + 1)
clusters = [{}] * (len(responses) + 1)
for r in responses:
    clusters[r] = {}
    for c in columns:
        clusters[r][c] = data[data["Response"] == r][c].median()
print(clusters)



"""Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð¼ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ðµ Ð¾Ñ†ÐµÐ½ÐºÐ¸ ÑÐºÐ¾Ñ€Ð¸Ð½Ð³Ð° Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÑ€ÐµÐ´Ð½Ð¸Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹"""

# Ð‘ÑƒÐ´ÐµÐ¼ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐµÐ²ÐºÐ»Ð¸Ð´Ð¾Ð²Ð¾ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ:
# ð·=sqrt(âˆ‘(ð‘Žð‘–âˆ’Ð¡ð‘–) ** 2),
# Ð³Ð´Ðµ ð‘Žð‘– âˆ’ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð² Ð² Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ñ‡Ð½Ð¾Ð¹
# Ð²Ñ‹Ð±Ð¾Ñ€ÐºÐµ ð¶ð‘– âˆ’ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ñ‚Ñ€Ð¾Ð² ÐºÐ»Ð°ÑÑ‚ÐµÑ€Ð¾Ð² Ð¿Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ð¼ Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‰ÐµÐ¹ Ð²Ñ‹Ð±Ð¾Ñ€ÐºÐ¸
# Ð’Ñ‹Ð±ÐµÑ€ÐµÐ¼ Ð¿Ñ€Ð¸Ð½Ð°Ð´Ð»ÐµÐ¶Ð½Ð¾ÑÑ‚ÑŒ Ðº ÐºÐ»Ð°ÑÑ‚ÐµÑ€Ñƒ, Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð¾ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾


def calc_model(x):
    D_min = 10000000
    target = 0
    for _, cluster in enumerate(clusters):
        if len(cluster) > 0:
            D = 0
            for c in columns:
                D += (cluster[c] - x[c]) ** 2
            D = np.sqrt(D)
            if D < D_min:
                target = _
                D_min = D
    x["target"] = target
    x["random"] = int(np.random.uniform(1, 8.01, 1)[0])
    x["sample"] = data.sample(1)["Response"].values[0]
    x["all8"] = 8
    return x


data_test = data_test.apply(calc_model, axis=1, result_type="expand")
print(data_test.head(20))


"""ÐžÑ†ÐµÐ½ÐºÐ° ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð° Ð¼Ð¾Ð´ÐµÐ»Ð¸: F1"""

# ÑÐºÐ¾Ñ€Ð¸Ð½Ð³ \ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ  8  1
#                         8  TP FP
#                         1  FN TN
# Ð¢Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ=ð‘‡ð‘ƒ/(ð‘‡ð‘ƒ+ð¹ð‘ƒ)
# ÐŸÐ¾Ð»Ð½Ð¾Ñ‚Ð°=ð‘‡ð‘ƒ/(ð‘‡ð‘ƒ+ð¹ð‘)
# ð¹1=2âˆ—(Ð¢Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒâˆ—ÐŸÐ¾Ð»Ð½Ð¾Ñ‚Ð°)/(Ð¢Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ+ÐŸÐ¾Ð»Ð½Ð¾Ñ‚Ð°)

print(
    "Ð¡Ð»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€:",
    f1_score(
        data_test["random"],
        data_test["Response"],
        average="weighted"
    )
)
print(
    "Ð’Ñ‹Ð±Ð¾Ñ€ Ð¿Ð¾ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ðµ:",
    f1_score(
        data_test["sample"],
        data_test["Response"],
        average="weighted"
    )
)
print(
    "ÐšÐ»Ð°ÑÑ‚ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ:",
    f1_score(
        data_test["target"],
        data_test["Response"],
        average="weighted"
    )
)
print(
    "Ð¡Ð°Ð¼Ñ‹Ð¹ Ð¿Ð¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ð¹:",
    f1_score(
        data_test["all8"],
        data_test["Response"],
        average="weighted"
    )
)


"""ÐœÐ°Ñ‚Ñ€Ð¸Ñ†Ð° Ð½ÐµÑ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÐµÐ¹"""

# ÑÐºÐ¾Ñ€Ð¸Ð½Ð³ \ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ  1   2   3   4   5   6   7   8
#                         1  TP FP1 FP2 FP3 FP4 FP5 FP6 FP7
#                         2  FN1 TP FP1 FP2 FP3 FP4 FP5 FP6
#                         3  FN2 FN1 TP FP1 FP2 FP3 FP4 FP5
#                         4  FN3 FN2 FN1 TP FP1 FP2 FP3 FP4
#                         5  FN4 FN3 FN2 FN1 TP FP1 FP2 FP3
#                         6  FN5 FN4 FN3 FN2 FN1 TP FP1 FP2
#                         7  FN6 FN5 FN4 FN3 FN2 FN1 TP FP1
#                         8  FN7 FN6 FN5 FN4 FN3 FN2 FN1 TP

print(confusion_matrix(data_test["target"], data_test["Response"]))


"""ÐšÐ²Ð°Ð´Ñ€Ð°Ñ‚Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ ÐºÐ°Ð¿Ð¿Ð° ÐšÐ¾ÑÐ½Ð°"""

# Ð¯Ð²Ð»ÑÐµÑ‚ÑÑ Ð»Ð¾Ð³Ð¸Ñ‡Ð½Ñ‹Ð¼ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸ÐµÐ¼ Ð¾Ñ†ÐµÐ½ÐºÐµ Ð¿Ð¾ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ðµ Ð½ÐµÑ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÐµÐ¹, Ð½Ð¾ Ð±Ð¾Ð»ÐµÐµ Ñ‚Ð¾Ñ‡Ð½Ð¾
# ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð½Ð° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð½Ñ‹Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¼, Ð¿Ð¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼
# Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ Ð²ÐµÑÐ¾Ð²: Ð±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð¹ Ð²ÐµÑ.
#
# Ð”Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ñ‚ÑŒ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ Ð²ÐµÑÐ¾Ð² (W), 8x8 Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ñ‚Ð°Ðº
# (ÐºÐ°Ð¶Ð´Ñ‹Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ - ÑÑ‚Ð¾ ÐºÐ²Ð°Ð´Ñ€Ð°Ñ‚ Ñ€Ð°Ð·Ð½Ð¸Ñ†Ñ‹ Ð¼ÐµÐ¶Ð´Ñƒ Ð½Ð¾Ð¼ÐµÑ€Ð¾Ð¼ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð¸ Ð½Ð¾Ð¼ÐµÑ€Ð¾Ð¼ ÑÑ‚Ð¾Ð»Ð±Ð°,
# Ñ€Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð½Ñ‹Ð¹ Ð½Ð° 64):

# Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ð° Ð²ÐµÑÐ¾Ð²         1         2         3         4         5         6         7         8
#             1         0  0.015625    0.0625  0.140625      0.25  0.390625    0.5625  0.765625
#             2  0.015625         0  0.015625    0.0625  0.140625      0.25  0.390625    0.5625
#             3    0.0625  0.015625         0  0.015625    0.0625      0.25  0.390625    0.5625
#             4  0.140625    0.0625  0.015625         0  0.015625    0.0625      0.25  0.390625
#             5      0.25  0.140625    0.0625  0.015625         0  0.015625    0.0625      0.25
#             6  0.390625      0.25  0.140625    0.0625  0.015625         0  0.015625    0.0625
#             7    0.5625  0.390625      0.25  0.140625    0.0625  0.015625         0  0.015625
#             8  0.765625    0.5625  0.390625      0.25  0.140625    0.0625  0.015625         0


# ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ñ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹ Ð½ÐµÑ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÐµÐ¹ (O) Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÑÑŽÑ‚ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ Ð³Ð¸ÑÑ‚Ð¾Ð³Ñ€Ð°Ð¼Ð¼
# Ñ€Ð°ÑÑ‡ÐµÑ‚Ð½Ñ‹Ñ… Ð¸ Ð¸Ð´ÐµÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ (E) - ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð²ÑÐµÐ³Ð¾ Ð¾Ñ†ÐµÐ½Ð¾Ðº 1, Ð¾Ñ†ÐµÐ½Ð¾Ðº 2, Ð¸ Ñ‚.Ð´.
# Ð’ ÑÐ»ÑƒÑ‡Ð°Ðµ Ð¾Ñ†ÐµÐ½Ð¾Ðº Ð¾Ñ‚ 1 Ð´Ð¾ 8 Ð³Ð¸ÑÑ‚Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹ Ð±ÑƒÐ´ÑƒÑ‚ Ð²Ñ‹Ð³Ð»ÑÐ´ÐµÑ‚ÑŒ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼:
#
# Ð Ð°ÑÑ‡ÐµÑ‚: [3372, 661, 1244, 1040, 1380, 276, 900, 3004]
#
# Ð˜Ð´ÐµÐ°Ð»: [1193, 1302, 207, 261, 1120, 2257, 1633, 3904]
#
# ÐšÐ°Ð¶Ð´Ñ‹Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹ ij - ÑÑ‚Ð¾ Ð¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ i-Ñ€Ð°ÑÑ‡ÐµÑ‚Ð½Ð¾Ð³Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ
# Ð½Ð° j-Ð¸Ð´ÐµÐ°Ð»ÑŒÐ½Ð¾Ðµ. ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð´Ð»Ñ ÑÑ‡ÐµÐ¹ÐºÐ¸ 1-1 ÑÑ‚Ð¾ Ð±ÑƒÐ´ÐµÑ‚ 3372 * 1193 = 4022796.
# Ð˜ Ñ‚.Ð´.
#
# ÐœÐ°Ñ‚Ñ€Ð¸Ñ†Ñƒ Ð½ÐµÑ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÐµÐ¹ Ð¸ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ Ð³Ð¸ÑÑ‚Ð¾Ð³Ñ€Ð°Ð¼Ð¼ Ð½Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÑŽÑ‚ (Ð´ÐµÐ»ÑÑ‚ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚
# Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹ Ð½Ð° ÑÑƒÐ¼Ð¼Ñƒ Ð²ÑÐµÑ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð²) Ð¸ Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÑÑŽÑ‚ Ð²Ð·Ð²ÐµÑˆÐµÐ½Ð½ÑƒÑŽ ÑÑƒÐ¼Ð¼Ñƒ, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ
# Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ Ð²ÐµÑÐ¾Ð² (ÐºÐ°Ð¶Ð´Ñ‹Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹ Ð²ÐµÑÐ¾Ð² ÑƒÐ¼Ð½Ð¾Ð¶Ð°ÑŽÑ‚ Ð½Ð° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¹
# ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹, Ð²ÑÐµ Ð¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ ÑÑƒÐ¼Ð¼Ð¸Ñ€ÑƒÑŽÑ‚): e = W * E, o = W * O.
#
# Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Kappa (ÐºÐ°Ð¿Ð¿Ð°) Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÑ‚ÑÑ ÐºÐ°Ðº 1 - o/e.

print(
    cohen_kappa_score(
        data_test["target"],
        data_test["Response"],
        weights="quadratic"
    )
)
print(
    cohen_kappa_score(
        data_test["all8"],
        data_test["Response"],
        weights="quadratic"
    )
)
